sequenceDiagram
    participant Admin
    participant UI
    participant Sistema
    participant AlertaService
    participant NotifService
    participant Usuario

    %% Admin inicia la creación de una alerta
    Admin->>UI: Crear alerta (tipo, titulo, mensaje, destinatarios)
    UI->>Sistema: POST /alertas {tipo, titulo, mensaje, destinatarios}

    %% Sistema valida y enruta según tipo
    Sistema->>Sistema: validar datos de alerta
    alt tipo == "ESTRENO"
        Sistema->>AlertaService: crearAlerta({tipo: ESTRENO, ...})
    else tipo == "PROMOCION"
        Sistema->>AlertaService: crearAlerta({tipo: PROMOCION, ...})
    else
        Sistema->>AlertaService: crearAlerta({tipo: AVISO, ...})
    end

    %% AlertaService persiste y relaciona a usuarios
    AlertaService->>AlertaService: guardar alerta en store
    AlertaService->>AlertaService: asignar a destinatarios (lista de usuarios)

    %% Para cada usuario destinatario: guardar en sus notificaciones y enviar
    loop por cada usuario destinatario
        AlertaService->>Usuario: push a listaNotificaciones (guardar)
        AlertaService->>NotifService: enviarNotificacion(usuario, alerta)
        NotifService-->>Usuario: notificacion (in-app/email/push)
    end

    %% Confirmación al Admin
    AlertaService-->>Sistema: alerta_creada(resultado)
    Sistema-->>UI: 201 Created (alerta_id)
    UI-->>Admin: mostrar "Alerta creada" (alerta_id)